---
- name: Configure Docker to use Nexus Docker Registry Mirror
  become: true
  ansible.builtin.copy:
    dest: /etc/docker/daemon.json
    content: |
      {
        "registry-mirrors": ["http://{{ dockerhub_nexus_mirror_nexus_base_url }}:{{ dockerhub_nexus_mirror_registry_port }}"],
        "insecure-registries" : ["{{ dockerhub_nexus_mirror_nexus_base_url }}:{{ dockerhub_nexus_mirror_registry_port }}"]
      }
    owner: root
    group: root
    mode: '0644'
  notify: Restart Docker
